<section class="max-w-6xl mx-auto px-4 py-12 md:px-8">
  <div class="text-center mb-10">
    <h2 class="text-xl md:text-2xl font-serif text-gray-800 tracking-[0.2em]">
      {{ section.settings.title }}
    </h2>
  </div>

  {% comment %} PC6列 / スマホ2列の設定 [cite: 2026-01-06] {% endcomment %}
  <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4 md:gap-6 items-center">
    {% for block in section.blocks %}
      {% assign brand = block.settings.brand_entry %}

      <div class="flex justify-center" {{ block.shopify_attributes }}>
        {% if brand != blank %}
          {% assign b_url = brand.brand_url %}
          {% if b_url == blank and brand.brand_name != blank %}
            {% assign b_url = brand.brand_name | url_for_vendor %}
          {% endif %}

          {% if b_url != blank %}
            <a href="{{ b_url }}" class="w-full opacity-90 hover:opacity-100 transition-opacity duration-500">
          {% else %}
            <div class="w-full">
          {% endif %}

          {% comment %}
            枠なし・透明背景・余白なし（p-0相当）の設定。
            形はカテゴリーと揃えて aspect-[4/5] にしているよ。
          {% endcomment %}
          <div class="aspect-[4/5] flex items-center justify-center overflow-hidden rounded-2xl">
            {% if brand.brand_logo != blank %}
              <img
                src="{{ brand.brand_logo | image_url: width: 300 }}"
                alt="{{ brand.brand_name | escape }}"
                class="max-w-full max-h-full object-contain mx-auto"
                loading="lazy"
              >
            {% endif %}
          </div>

          {% if b_url != blank %}
            </a>
          {% else %}
            </div>
          {% endif %}
        {% else %}
          {% if request.design_mode %}
            <div class="w-full aspect-[4/5] bg-gray-200 rounded-2xl flex items-center justify-center p-2 text-center">
              <span class="text-gray-500 text-[9px] md:text-[10px]"> ブランドを選択してください </span>
            </div>
          {% endif %}
        {% endif %}
      </div>
    {% endfor %}
  </div>
</section>

{% schema %}
{
  "name": "ブランド一覧",
  "settings": [
    {
      "type": "text",
      "id": "title",
      "label": "セクション見出し",
      "default": "ブランド"
    }
  ],
  "blocks": [
    {
      "type": "brand",
      "name": "ブランド",
      "settings": [
        {
          "type": "metaobject",
          "id": "brand_entry",
          "label": "ブランドを選択",
          "metaobject_type": "brand"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "ブランド一覧",
      "settings": {
        "title": "ブランド"
      },
      "blocks": [
        { "type": "brand" },
        { "type": "brand" },
        { "type": "brand" },
        { "type": "brand" },
        { "type": "brand" },
        { "type": "brand" }
      ]
    }
  ]
}
{% endschema %}
